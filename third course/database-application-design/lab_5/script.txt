CREATE SEQUENCE ids_kaf;
CREATE TABLE kaf (
 id_kaf INTEGER PRIMARY KEY DEFAULT NEXTVAL('ids_kaf'),
 name_kaf VARCHAR UNIQUE NOT NULL
 );


CREATE SEQUENCE ids_unit;
CREATE TABLE unit (
 id_unit INTEGER PRIMARY KEY DEFAULT NEXTVAL('ids_unit'),
 name_unit VARCHAR UNIQUE NOT NULL, 
 ed REAL NOT NULL
 );

CREATE SEQUENCE ids_prep;
CREATE TABLE prepodavatel (
id_prepod INTEGER PRIMARY KEY DEFAULT NEXTVAL('ids_prep'), 
name_prepod VARCHAR UNIQUE NOT NULL
);

CREATE SEQUENCE ids_sphere;
CREATE TABLE sphere (
 id_sph INTEGER PRIMARY KEY DEFAULT NEXTVAL('ids_sphere'),
 name_sph VARCHAR UNIQUE NOT NULL, id_unit INTEGER NOT NULL,
 FOREIGN KEY(id_unit) REFERENCES unit(id_unit) ON DELETE CASCADE ON UPDATE CASCADE
  );
  
CREATE SEQUENCE ids_index;
CREATE TABLE index (
 id_ind INTEGER PRIMARY KEY DEFAULT NEXTVAL('ids_index'),
 name_ind VARCHAR UNIQUE NOT NULL,
 sphere_id_sph INTEGER NOT NULL,
 FOREIGN KEY(sphere_id_sph) REFERENCES sphere(id_sph) ON DELETE CASCADE ON UPDATE CASCADE
 );
 
CREATE SEQUENCE ids_work;
CREATE TABLE work (
id_work INTEGER PRIMARY KEY DEFAULT NEXTVAL('ids_work'), 
name_work VARCHAR, 
id_ind INTEGER NOT NULL, 
id_kaf INTEGER NOT NULL, 
id_prepod INTEGER NOT NULL, 
year INTEGER NOT NULL, 
volume REAL NOT NULL,
FOREIGN KEY(id_ind) REFERENCES index(id_ind) ON DELETE CASCADE ON UPDATE CASCADE, 
FOREIGN KEY(id_kaf) REFERENCES kaf(id_kaf) ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY(id_prepod) REFERENCES prepodavatel(id_prepod) ON DELETE CASCADE ON UPDATE CASCADE,
UNIQUE(name_work,id_ind,id_kaf,id_prepod,year)
);

